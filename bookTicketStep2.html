<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Ticket</title>
    <link href="./access/bootstrap-5.3.3-dist/css/bootstrap502.min.css" rel="stylesheet" >
    <script src="./access/bootstrap-5.3.3-dist/js/jquery-3.3.1.js"></script>
    
    <script> 
        $(document).ready(function(){
          $("#header").load("./header.html"); 
            window.addEventListener("load", (event) => {
                $('.step1').addClass('current');
            });
        });
    </script> 
    <script src="./access/bootstrap-5.3.3-dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="./access/css/bookTicket.css">
    <link rel="stylesheet" href="./access/css/css2.css">
    <script src="./access/js/bookTicket.js" defer></script>
</head>
<body>
    <div class="page">
        <header id="header">
        </header>
        <div class="container__wrapper">
            <h4 class="containerTiltle">Bước 2: Chọn ghế</h4>
            <div class="containerStepContent">
                <div class="container">
                    <div class="row">
                      <div class="col-xxl-4 col-xl-4 col-lg-4">
                        <div class="contentLeft">
                            <div class="filmCart">
                                <div class="addressFilmCart">
                                    <h4 class="addressFilmCartTitle">BHD Star Le Van Viet</h4>
                                    <span class="screen">Screen 6</span> - 24/2/2024 - Suất chiếu: 17h20
                                </div>
                                <div class="nameFilmCart">
                                    <h3 class="nameFilmCartTilte">Mai</h3>
                                    <div class="meta">
                                        <span class="age-limit T18">T18</span>
                                        <span class="type">Phụ đề</span>
                                        <span class="format">2D</span>
                                    </div>
                                </div>
                                <table class="cart-items"><tbody><tr><td class="title"><span class="quantity">1</span>&nbsp;<span>x</span>&nbsp;<span class="name">Adult-Stand-2D</span><br><span class="description">B17</span></td><td class="price">100.000&nbsp;VND</td></tr></tbody></table>
                                <div class="sumMoney">
                                    <span class="text">
                                        Tổng tiền
                                    </span>
                                    <span class="numberPrice">
                                        
                                    </span>
                                </div>
                                <button style="padding: 0;" onclick="chondoAn(event)" class="chonDoAnBtn">
                                    <a style="display: block; color: white; padding: 10px 0px;" href="#">
                                        Chọn đồ ăn (2/4)
                                    </a>
                                </button>
                                <div class="backPage">
                                    <a href="#">← Trở lại</a>
                                </div>
                                <div class="timelife">
                                    <span class="timelifeNumber">Còn lại 5 phút, 55 giây</span>
                                </div>
                            </div>
                        </div>
                      </div>
                      <div class="col-xxl-8 col-xl-8 col-lg-8">
                        <div class="contentRight">
                            <div class="cinemaMapContent">
                                <table>
                                    <tbody class="seatList">
                                        <tr>
                                            <td></td>
                                            <td colspan="20">
                                                <div class="mapHeader">
                                                    <img src="./access/image/seatMapHeader.png" alt="screen">
                                                </div>
                                                <div class="seatTypes">
                                                    <div class="container">
                                                        <div class="row">
                                                            <div class="col-sm">
                                                                <div class="seatItem">
                                                                    <img src="./access/image/ghe-thuong.png" alt="ghe">
                                                                    <span>Ghế thuờng</span>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm">
                                                                <div class="seatItem">
                                                                    <img src="./access/image/ghe-vip.png" alt="ghe">
                                                                    <span>Ghế VIP</span>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm">
                                                                <div class="seatItem">
                                                                    <img src="./access/image/ghe-doi.png" alt="ghe">
                                                                    <span>Ghế đôi</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row" style="margin-top: 20px;">
                                                        <div class="col-sm-5">
                                                            <div class="seatItem" style="margin-left: 166px;text-align: center;">
                                                                <img src="./access/image/ghe-da-chon.png" alt="ghe">
                                                                <span>Ghế đã chọn</span>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-5">
                                                            <div class="seatItem" style="text-align: center;">
                                                                <img src="./access/image/ghe-da-ban.png" alt="ghe">
                                                                <span>Ghế đã bán</span>
                                                            </div>
                                                        </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td></td>
                                        </tr>  
                                    </tbody> 
                                </table>
                                <div class="listSeat">
                                    
                                </div>
                            </div>
                        </div>
                      </div>
                    </div>
                </div>
            </div>
        </div>
        <footer class="footer">
        </footer>
    </div>
</body>
</html>

<script>
    let slGhe = 1;
    let filmChose = JSON.parse(localStorage.getItem('filmChose'));
    $('.numberPrice').text(`${filmChose.price} VND`)
    $('.nameFilmCartTilte').text(`${filmChose.filmName} `)
    function chondoAn(event){
        if($('.seat-checked').length == 0){
            alert("chua co ghe ngoi duoc chon");
        }else{
            let chairArr = [];
            $('.seat-checked').each(function(){
                const chairName = $(this).attr('id');
                chairArr.push(chairName);
            });
            filmChose = {
                ...filmChose,
                chairArr,
                price: filmChose.price * slGhe,
                slGhe,
            }
            localStorage.setItem('filmChose', JSON.stringify(filmChose));
            window.location.href = './bookTicketStep3.html'
        }
    }
    $(document).ready(function(){
        let checkSeat = function(ele){
            const alphas = ['D','E','F','G','H','I'];
            if(alphas.includes(ele)){
                return true;
            }
            return false;
        }
        let alphabet = ['A','B','C','D','E','F','G','H','I'];
        let htmlSeats = alphabet.map((ele,index)=>{
            return `
            <div class="row">
                <span class="alpha">${ele}</span>
                <span id="seat-${ele}-1" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? '' : ''}"></span>
                <span id="seat-${ele}-2" class="seat  seat-sold ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? '' : ''}"></span>
                <span id="seat-${ele}-3" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? '' : ''}"></span>
                <span id="seat-${ele}-4" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? 'pair-seat' : ''}"></span>
                <span id="seat-${ele}-5" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? 'pair-seat' : ''}"></span>
                <span id="seat-${ele}-6" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? 'pair-seat' : ''}"></span>
                <span id="seat-${ele}-7" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? 'pair-seat' : ''}"></span>
                <span id="seat-${ele}-8" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? 'pair-seat' : ''}"></span>
                <span id="seat-${ele}-9" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? 'pair-seat' : ''}"></span>
                <span id="seat-${ele}-10" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? 'pair-seat' : ''}"></span>
                <span id="seat-${ele}-11" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? 'pair-seat' : ''}"></span>
                <span id="seat-${ele}-12" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? 'pair-seat' : ''}"></span>
                <span id="seat-${ele}-13" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? '' : ''}"></span>
                <span id="seat-${ele}-14" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? '' : ''}"></span>
                <span id="seat-${ele}-15" class="seat  ${ele == 'I' ? 'I' : ""} ${checkSeat(ele) ? '' : ''}"></span>
                <span class="alpha">${ele}</span>
            </div>
            `
        }).join("");
        $('.listSeat').append(htmlSeats.toString());
        $('.seat').click(function(){
            // console.log(1);
            const checkClass = $(this).hasClass('seat-checked'); 
            if(checkClass){
                $(this).removeClass('seat-checked');
            }else{
                $(this).addClass('seat-checked');
            }
            slGhe = Number($('.seat-checked').length);
            $('.numberPrice').text(`${filmChose.price * slGhe} VND`)
            $('.quantity').text(`${slGhe}`)
        })

    })


</script>
